<!DOCTYPE html><html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jeu de Recherche Visuelle - Mariage</title>
  <style>
    body { font-family: sans-serif; text-align: center; background-color: #fef8f4; }
    #game-container { position: relative; display: inline-block; }
    #wedding-image { max-width: 100%; height: auto; }
    .target { position: absolute; border: 2px solid transparent; cursor: pointer; }
    .found { border-color: green; }
    #current-word { font-size: 1.5em; margin: 10px; }
    #results, #leaderboard { margin-top: 20px; }
  </style>  <!-- Firebase -->  <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js"></script>  <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore.js"></script>  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAAIr_vGlCMM9iuRwnqOQhb2cwv7DIVJFk",
      authDomain: "classementjeu-a2f8a.firebaseapp.com",
      projectId: "classementjeu-a2f8a",
      storageBucket: "classementjeu-a2f8a.appspot.com",
      messagingSenderId: "70538879353",
      appId: "1:70538879353:web:05b35cb2c3930c34380fa8",
      measurementId: "G-JXNCRWDN5C"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script></head>
<body>
  <h1>üéØ Jeu de Recherche - Sp√©cial Mariage</h1>
  <div id="current-word">
    Cliquez sur : <strong id="word"></strong><br>
    ‚è±Ô∏è Temps : <span id="timer">0.0</span> sec
  </div>
  <div id="game-container">
    <img id="wedding-image" src="scene.png" alt="Sc√®ne de mariage">
  </div>
  <div id="results"></div>
  <div id="leaderboard"><h2>üèÜ Classement</h2><ul id="scores"></ul></div>  <script>
    const mots = ["chaussure femme", "Bretelles", "Carte d'identit√©", "Ceinture", "Clef", "Mari√© H", "Brosse", "Mari√©e F", "Mouchoir orange", "N≈ìud papillon", "Portefeuille", "Rouge √† l√®vre", "Tasse"];
    const zones = [
      { nom: "Clef", x: 3.2, y: 3.2, w: 19, h: 14.8, intrus: false },
      { nom: "Portefeuille", x: 55.5, y: 3.2, w: 77.5, h: 13.7, intrus: false },
      { nom: "Ceinture", x: 4.8, y: 27.4, w: 23.7, h: 33.7, intrus: false },
      { nom: "Mari√© H", x: 47.4, y: 14.8, w: 59.1, h: 48.4, intrus: false },
      { nom: "Mari√©e F", x: 59.3, y: 15.8, w: 75.9, h: 48.4, intrus: false },
      { nom: "Brosse", x: 87.1, y: 36.9, w: 95.6, h: 52.6, intrus: false },
      { nom: "Tasse", x: 6.4, y: 47.4, w: 19, h: 54.7, intrus: false },
      { nom: "Rouge √† l√®vre", x: 43.7, y: 55.8, w: 48.2, h: 66.3, intrus: false },
      { nom: "Bretelles", x: 42.4, y: 66.4, w: 59.1, h: 76.9, intrus: false },
      { nom: "N≈ìud papillon", x: 59.8, y: 75.5, w: 73.4, h: 80.8, intrus: false },
      { nom: "Carte d'identit√©", x: 77, y: 71.4, w: 87.6, h: 77.9, intrus: false },
      { nom: "Mouchoir orange", x: 61.8, y: 82.2, w: 72.4, h: 87.5, intrus: false },
      { nom: "chaussure femme", x: 46.7, y: 88.4, w: 55, h: 92, intrus: false }
    ];

    const container = document.getElementById("game-container");
    const wordDisplay = document.getElementById("word");
    const results = document.getElementById("results");
    const scoresList = document.getElementById("scores");
    let index = 0, startTime = 0, totalPenalty = 0, times = [], intervalId;
    const timerDisplay = document.getElementById("timer");

    function showWord() {
      wordDisplay.textContent = mots[index];
      startTime = Date.now();
      if (intervalId) clearInterval(intervalId);
      intervalId = setInterval(() => {
        const t = (Date.now() - startTime) / 1000;
        timerDisplay.textContent = t.toFixed(1);
      }, 100);
    }

    function endGame() {
      const total = times.reduce((a, b) => a + b, 0) + totalPenalty;
      results.innerHTML = `<h2>R√©sultat :</h2>`;
      mots.forEach((m, i) => {
        results.innerHTML += `<p>${m} : ${times[i].toFixed(2)} sec</p>`;
      });
      if (totalPenalty > 0) results.innerHTML += `<p>P√©nalit√© : +${totalPenalty} sec</p>`;
      results.innerHTML += `<h3>Temps total : ${total.toFixed(2)} sec</h3>`;

      const pseudo = prompt("Entrez votre Pr√©nom pour le classement :");
      if (pseudo) {
        db.collection("scores").add({
          pseudo: pseudo,
          temps: parseFloat(total.toFixed(2)),
          date: firebase.firestore.Timestamp.now()
        }).then(() => {
          console.log("Score enregistr√© dans Firebase");
          loadLeaderboard();
        }).catch((error) => {
          console.error("Erreur lors de l'enregistrement :", error);
        });
      }
    }

    function setupZones() {
      zones.forEach(zone => {
        const div = document.createElement("div");
        div.classList.add("target");
        div.style.left = zone.x + "%";
        div.style.top = zone.y + "%";
        div.style.width = zone.w + "%";
        div.style.height = zone.h + "%";
        div.dataset.nom = zone.nom;
        div.dataset.intrus = zone.intrus;
        div.onclick = () => handleClick(zone);
        container.appendChild(div);
      });
    }

    function handleClick(zone) {
      if (zone.intrus) {
        totalPenalty += 1;
        alert(`Intrus cliqu√© : ${zone.nom} (+1s)`);
        return;
      }
      if (zone.nom === mots[index]) {
        const timeTaken = (Date.now() - startTime) / 1000;
        times.push(timeTaken);
        index++;
        if (index < mots.length) showWord();
        else {
          wordDisplay.textContent = "‚úîÔ∏è Termin√© !";
          endGame();
        }
      }
    }

    function loadLeaderboard() {
      db.collection("scores")
        .orderBy("temps", "asc")
        .limit(10)
        .get()
        .then(querySnapshot => {
          scoresList.innerHTML = "";
          querySnapshot.forEach(doc => {
            const data = doc.data();
            scoresList.innerHTML += `<li><strong>${data.pseudo}</strong> : ${data.temps} s</li>`;
          });
        })
        .catch(error => {
          console.error("Erreur classement :", error);
        });
    }

    setupZones();
    showWord();
    loadLeaderboard();
    clearInterval(intervalId);
  </script></body>
</html>
